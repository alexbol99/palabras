<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Palabras - learn spanish words</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="./css/jquery.mobile-1.4.5.css" rel="stylesheet" type="text/css"/>
    <script>
        var stage;

        function init() {
            stage = new createjs.Stage("demoCanvas");

            createjs.Touch.enable(stage);
            // enabled mouse over / out events
            stage.enableMouseOver(10);
            stage.mouseMoveOutside = true; // keep tracking the mouse even when it leaves the canvas

            var text1 = new createjs.Text("Hello", "100px Arial", "#ff7700");
            text1.x = 50;
            text1.y = 50;
            text1.textBaseline = "top";
            stage.addChild(text1);
            setHitArea(text1);

            var text2 = new createjs.Text("World", "100px Arial", "#ff7700");
            text2.x = 350;
            text2.y = 50;
            text2.textBaseline = "top";
            stage.addChild(text2);
            setHitArea(text2);

            text1.on("mousedown", function(evt) {
                this.offset = {x:this.x-evt.stageX, y:this.y-evt.stageY};
                this.dragStarted = true;
            });
            // the pressmove event is dispatched when the mouse moves after a mousedown on the target until the mouse is released.
            text1.on("pressmove", function(evt) {
                if (this.dragStarted) {
                    this.x = evt.stageX + this.offset.x;
                    this.y = evt.stageY + this.offset.y;
                    stage.update();
                }
            });

            text1.on("pressup", function(event) {
                var my_text = this;     // event.currentTarget;
                var center = getCenter(my_text);
                var objects = stage.getObjectsUnderPoint(center.x, center.y, 0);

                var other_text = undefined;
                objects.forEach(function(object) {
                    if (object != my_text) {
                        other_text = object;
                    }
                });

                if (other_text) {
                    other_text.text = my_text.text + other_text.text;   // "Hello World";
                    my_text.text = "";

                    createjs.Tween.get(other_text, {loop: false})
                            .to({alpha: 0, y: 0}, 1500, createjs.Ease.getPowInOut(2))
                    /*
                     .to({x: 400}, 1000, createjs.Ease.getPowInOut(4))
                     .to({alpha: 0, y: 75}, 500, createjs.Ease.getPowInOut(2))
                     .to({alpha: 0, y: 125}, 100)
                     .to({alpha: 1, y: 100}, 500, createjs.Ease.getPowInOut(2))
                     .to({x: 100}, 800, createjs.Ease.getPowInOut(2));
                     */
                    createjs.Ticker.setFPS(60);
                    createjs.Ticker.addEventListener("tick", stage);
                    // stage.update();
                }

                this.dragStarted = false;
            });

            stage.update();
        }

        function setHitArea(text) {
            var hitArea = new createjs.Shape();
            var textWidth = text.getMeasuredWidth();
            var textHeight = text.getMeasuredHeight();
            hitArea.graphics.beginFill("#000").drawRect(0, 0, text.getMeasuredWidth(), text.getMeasuredHeight());
            hitArea.x = 0;
            hitArea.y = 0;
            text.hitArea = hitArea;
        }

        function getCenter(text) {
            var textWidth = text.getMeasuredWidth();
            var textHeight = text.getMeasuredHeight();
            return {x: text.x + textWidth/2, y: text.y + textHeight/2};
        }

    </script>
</head>
<body onLoad="init();">
    <div data-role="page">
        <select name="select-custom-1" id="select-custom-1" data-native-menu="false">
            <option value="1">The 1st Option</option>
            <option value="2">The 2nd Option</option>
            <option value="3">The 3rd Option</option>
            <option value="4">The 4th Option</option>
        </select>
        <!--<div data-role="header">-->
            <!--<h1>Page Title</h1>-->
            <!--<div class="ui-field-contain">-->
            <!--</div>-->
        <!--</div>&lt;!&ndash; /header &ndash;&gt;-->

        <div role="main" class="ui-content">
            <canvas id="demoCanvas" width="950" height="500"></canvas>
        </div><!-- /content -->

        <div data-role="footer">
            <h4>Page Footer</h4>
        </div><!-- /footer -->

    </div>

    <script src="./js/lib/easeljs-0.8.0.min.js"></script>
    <script src="./js/lib/tweenjs-0.6.0.min.js"></script>
    <script src="./js/lib/jquery-2.1.3.min.js"></script>
    <script src="./js/lib/jquery.mobile-1.4.5.min.js"></script>

</body>
</html>